#!/bin/bash
podman volume inspect imixs_dbdata > /dev/null || podman volume create imixs_dbdata > /dev/null
podman create --name=imixs_imixs-db_1 --label io.podman.compose.config-hash=123 --label io.podman.compose.project=imixs --label io.podman.compose.version=0.0.1 --label com.docker.compose.container-number=1 --label com.docker.compose.service=imixs-db --network host -e POSTGRES_PASSWORD=adminadmin -e POSTGRES_DB=workflow-db --mount type=bind,source=/home/twobrowin/.local/share/containers/storage/volumes/imixs_dbdata/_data,destination=/var/lib/postgresql/data,bind-propagation=z --add-host imixs-db:127.0.0.1 --add-host imixs_imixs-db_1:127.0.0.1 --add-host imixs-app:127.0.0.1 --add-host imixs_imixs-app_1:127.0.0.1 postgres:9.6.1
podman create --name=imixs_imixs-app_1 --label io.podman.compose.config-hash=123 --label io.podman.compose.project=imixs --label io.podman.compose.version=0.0.1 --label com.docker.compose.container-number=1 --label com.docker.compose.service=imixs-app --network host -e DATABASE_PROVIDER=postgres -e POSTGRES_HOST=db -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=adminadmin -e POSTGRES_DATABASE=workflow -e POSTGRES_CONNECTION=jdbc:postgresql://imixs-db/workflow-db -e JWT_SECRET=my-secure-secret -e JWT_EXPIRE=3600 -e MP_OPENAPI_SERVERS=http://localhost:8080 --add-host imixs-db:127.0.0.1 --add-host imixs_imixs-db_1:127.0.0.1 --add-host imixs-app:127.0.0.1 --add-host imixs_imixs-app_1:127.0.0.1 -p 8080:8080 imixs/imixs-microservice
podman start imixs_imixs-db_1
podman start imixs_imixs-app_1 -a
